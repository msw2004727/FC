<!DOCTYPE html>
<html lang="zh-Hant" data-theme="light">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SportHub — 運動報名系統 Demo</title>
  <link rel="stylesheet" href="style.css?v=20260209">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700;900&family=Outfit:wght@400;500;600;700;800&display=swap" rel="stylesheet">
</head>
<body>

  <!-- ============ TOP BAR ============ -->
  <header id="top-bar">
    <button id="menu-toggle" aria-label="選單">
      <span></span><span></span><span></span>
    </button>
    <div class="logo">
      <span class="logo-text">圖斯特Hub Demo</span>
    </div>
    <div class="top-bar-right">
      <div class="sport-picker-wrapper" id="sport-picker-wrapper">
        <button class="sport-picker-btn" id="sport-picker-btn" aria-label="選擇運動類別">
          <span class="sport-picker-icon">⚽</span>
        </button>
        <div class="sport-picker-dropdown" id="sport-picker-dropdown">
          <div class="sport-picker-header">選擇運動類別</div>
          <button class="sport-picker-item active" data-sport="football">
            <span class="sp-icon">⚽</span><span>足球</span>
          </button>
          <button class="sport-picker-item locked" data-sport="basketball" disabled>
            <span class="sp-icon">🏀</span><span>籃球</span><span class="sp-lock">🔒</span>
          </button>
          <button class="sport-picker-item locked" data-sport="volleyball" disabled>
            <span class="sp-icon">🏐</span><span>排球</span><span class="sp-lock">🔒</span>
          </button>
          <button class="sport-picker-item locked" data-sport="tennis" disabled>
            <span class="sp-icon">🎾</span><span>網球</span><span class="sp-lock">🔒</span>
          </button>
          <button class="sport-picker-item locked" data-sport="badminton" disabled>
            <span class="sp-icon">🏸</span><span>羽球</span><span class="sp-lock">🔒</span>
          </button>
        </div>
      </div>
      <button id="notif-btn" aria-label="通知">
        <svg viewBox="0 0 24 24" width="22" height="22" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 8A6 6 0 006 8c0 7-3 9-3 9h18s-3-2-3-9"/><path d="M13.73 21a2 2 0 01-3.46 0"/></svg>
        <span class="notif-badge">3</span>
      </button>
      <div class="role-switcher-wrapper" id="role-switcher-wrapper">
        <button id="role-avatar-btn" class="role-avatar-btn" aria-label="切換身份">
          <div class="role-avatar">麥</div>
          <span class="role-current-label">一般用戶</span>
          <span class="role-arrow">▼</span>
        </button>
        <div id="role-dropdown" class="role-dropdown">
          <div class="role-dropdown-header">切換 Demo 身份</div>
          <button class="role-dropdown-item active" data-role="user">
            <span class="role-icon">U</span>
            <span>一般用戶</span>
          </button>
          <button class="role-dropdown-item" data-role="coach">
            <span class="role-icon">C</span>
            <span>教練</span>
          </button>
          <button class="role-dropdown-item" data-role="captain">
            <span class="role-icon">L</span>
            <span>領隊</span>
          </button>
          <button class="role-dropdown-item" data-role="venue_owner">
            <span class="role-icon">V</span>
            <span>場主</span>
          </button>
          <button class="role-dropdown-item" data-role="admin">
            <span class="role-icon">A</span>
            <span>管理員</span>
          </button>
          <button class="role-dropdown-item" data-role="super_admin">
            <span class="role-icon">S</span>
            <span>總管</span>
          </button>
        </div>
      </div>
    </div>
  </header>

  <!-- ============ SIDE DRAWER ============ -->
  <div id="drawer-overlay"></div>
  <nav id="side-drawer">
    <div class="drawer-header">
      <div class="drawer-user">
        <div class="drawer-avatar">麥</div>
        <div>
          <div class="drawer-name">冠軍.全勤.小麥</div>
          <div class="drawer-role-tag" id="drawer-role-tag">一般用戶</div>
        </div>
      </div>
    </div>
    <div class="drawer-menu" id="drawer-menu">
      <!-- Dynamically populated -->
    </div>
    <div class="drawer-footer">
      <button id="theme-toggle">
        <span class="theme-icon"></span>
        <span>深色模式</span>
        <div class="toggle-switch active"><div class="toggle-knob"></div></div>
      </button>
    </div>
  </nav>

  <!-- ============ MAIN CONTENT ============ -->
  <main id="main-content">

    <!-- PAGE: Home -->
    <section class="page active" id="page-home">
      <!-- Banner Carousel -->
      <div class="banner-carousel">
        <div class="banner-track" id="banner-track">
          <div class="banner-slide banner-placeholder">
            <div class="banner-img-placeholder">1200 × 400</div>
            <div class="banner-content">
              <div class="banner-tag">聯賽</div>
              <h2>2026 春季足球聯賽</h2>
              <p>報名開始！12 支隊伍角逐冠軍</p>
            </div>
          </div>
          <div class="banner-slide banner-placeholder">
            <div class="banner-img-placeholder">1200 × 400</div>
            <div class="banner-content">
              <div class="banner-tag">活動</div>
              <h2>週末足球友誼賽</h2>
              <p>每週六下午・新手歡迎</p>
            </div>
          </div>
          <div class="banner-slide banner-placeholder">
            <div class="banner-img-placeholder">1200 × 400</div>
            <div class="banner-content">
              <div class="banner-tag">二手</div>
              <h2>二手球具特賣展示</h2>
              <p>優質球鞋、球衣・超值好物</p>
            </div>
          </div>
        </div>
        <button class="banner-arrow banner-arrow-left" id="banner-prev">‹</button>
        <button class="banner-arrow banner-arrow-right" id="banner-next">›</button>
        <div class="banner-dots" id="banner-dots"></div>
      </div>

      <!-- System Announcement -->
      <div class="announce-card" id="announce-card">
        <div class="announce-header">
          <span>系統公告</span>
        </div>
        <div class="announce-body" id="announce-body"></div>
      </div>

      <!-- Hot Events -->
      <div class="section-title">近期熱門活動</div>
      <div class="horizontal-scroll" id="hot-events">
        <!-- Populated by JS -->
      </div>

      <!-- Ongoing Tournaments -->
      <div class="section-title">進行中賽事</div>
      <div class="horizontal-scroll" id="ongoing-tournaments">
        <!-- Populated by JS -->
      </div>

      <!-- Floating Ads (Populated by JS) -->
      <div class="floating-ads" id="floating-ads"></div>
    </section>

    <!-- PAGE: Activities -->
    <section class="page" id="page-activities">
      <div class="page-header">
        <h2>活動行事曆</h2>
        <button class="filter-btn" id="filter-toggle">篩選 ▾</button>
      </div>
      <div class="filter-bar" id="filter-bar">
        <select><option>全部類別</option><option>友誼賽</option><option>訓練</option><option>學習營</option><option>聯賽</option><option>盃賽</option><option>測試</option><option>觀賽</option></select>
        <select><option>全部地區</option><option>台北</option><option>台中</option><option>高雄</option></select>
        <input type="text" placeholder="搜尋活動...">
      </div>
      <!-- Coach+ : My Activity Management -->
      <div class="my-section" data-min-role="coach">
        <button class="action-btn" onclick="App.showPage('page-my-activities')">我的活動管理</button>
      </div>
      <div class="timeline-calendar" id="activity-list">
        <!-- Populated by JS -->
      </div>
    </section>

    <!-- PAGE: Activity Detail -->
    <section class="page" id="page-activity-detail">
      <div class="page-header">
        <button class="back-btn" onclick="App.goBack()">←</button>
        <h2 id="detail-title">活動名稱</h2>
      </div>
      <div class="td-img-placeholder" id="detail-img-placeholder">活動圖片 800 × 300</div>
      <div class="detail-body" id="detail-body">
        <!-- Populated by JS -->
      </div>
    </section>

    <!-- PAGE: Teams -->
    <section class="page" id="page-teams">
      <div class="page-header">
        <h2>球隊</h2>
      </div>
      <div class="team-search-bar">
        <input type="text" id="team-search" placeholder="搜尋球隊名稱..." oninput="App.filterTeams()">
        <select id="team-region-filter" onchange="App.filterTeams()">
          <option value="">全部地區</option>
          <option value="台北市">台北市</option>
          <option value="新北市">新北市</option>
          <option value="桃園市">桃園市</option>
          <option value="台中市">台中市</option>
          <option value="高雄市">高雄市</option>
        </select>
      </div>
      <div class="my-section" data-min-role="captain">
        <button class="action-btn" onclick="App.showPage('page-team-manage')">球隊管理</button>
      </div>
      <div class="team-grid" id="team-list">
        <!-- Populated by JS -->
      </div>
    </section>

    <!-- PAGE: Team Detail -->
    <section class="page" id="page-team-detail">
      <div class="page-header">
        <button class="back-btn" onclick="App.goBack()">←</button>
        <h2 id="team-detail-title">球隊名稱</h2>
        <span class="team-detail-name-en" id="team-detail-name-en"></span>
      </div>
      <div class="td-img-placeholder" id="team-detail-img">球隊封面 800 × 300</div>
      <div class="detail-body" id="team-detail-body"></div>
    </section>

    <!-- PAGE: Messages -->
    <section class="page" id="page-messages">
      <div class="page-header">
        <h2>訊息</h2>
        <button class="text-btn">全讀</button>
      </div>
      <div class="tab-bar">
        <button class="tab active" data-tab="all">全部</button>
        <button class="tab" data-tab="system">系統</button>
        <button class="tab" data-tab="activity">活動</button>
        <button class="tab" data-tab="trade">交易</button>
        <button class="tab" data-tab="private">私訊</button>
      </div>
      <div class="card-list" id="message-list">
        <!-- Populated by JS -->
      </div>
      <div class="storage-bar">剩餘容量：<strong>38</strong>/50</div>
    </section>

    <!-- PAGE: Profile (My) -->
    <section class="page" id="page-profile">
      <div class="profile-header">
        <div class="profile-avatar">麥</div>
        <div class="profile-title" id="profile-title">冠軍.全勤.小麥</div>
        <div class="profile-level">
          <span>Lv.25</span>
          <div class="exp-bar"><div class="exp-fill" style="width:78%"></div></div>
          <span class="exp-text">2350 / 3000</span>
        </div>
      </div>
      <div class="profile-stats">
        <div class="stat-item"><span class="stat-num">42</span><span class="stat-label">參加場次</span></div>
        <div class="stat-item"><span class="stat-num">38</span><span class="stat-label">完成</span></div>
        <div class="stat-item"><span class="stat-num">90%</span><span class="stat-label">出席率</span></div>
        <div class="stat-item"><span class="stat-num">4</span><span class="stat-label">徽章</span></div>
      </div>
      <div class="quick-grid">
        <button class="quick-item" onclick="App.showPage('page-qrcode')">QR Code</button>
        <button class="quick-item disabled" disabled>紙娃娃</button>
        <button class="quick-item" onclick="App.showPage('page-achievements')">成就</button>
        <button class="quick-item" onclick="App.showPage('page-badges')">徽章</button>
        <button class="quick-item" onclick="App.showPage('page-titles')">稱號</button>
        <button class="quick-item" onclick="App.goMyTeam()">球隊</button>
      </div>
      <div class="info-card">
        <div class="info-title">我的資料</div>
        <div class="info-row"><span>性別</span><span>男</span></div>
        <div class="info-row"><span>生日</span><span>1995/03/15</span></div>
        <div class="info-row"><span>地區</span><span>台北市 <button class="edit-btn">編輯</button></span></div>
        <div class="info-row"><span>運動類別</span><span>足球、籃球</span></div>
        <div class="info-row"><span>所屬球隊</span><span>雷霆隊</span></div>
        <div class="info-row contact-row" data-min-role="coach"><span>聯繫方式</span><span>0912-345-678 <button class="edit-btn">編輯</button></span></div>
      </div>
      <div class="info-card">
        <div class="info-title">報名紀錄</div>
        <div class="tab-bar compact" id="record-tabs">
          <button class="tab active" data-filter="all">全部</button>
          <button class="tab" data-filter="completed">完成</button>
          <button class="tab" data-filter="cancelled">取消</button>
          <button class="tab" data-filter="early-left">早退</button>
        </div>
        <div class="mini-activity-list" id="my-activity-records"></div>
      </div>
    </section>

    <!-- PAGE: QR Code -->
    <section class="page" id="page-qrcode">
      <div class="page-header">
        <button class="back-btn" onclick="App.goBack()">←</button>
        <h2>我的 QR Code</h2>
      </div>
      <div class="center-content">
        <div class="qr-placeholder">
          <div class="qr-box">QR<br>CODE</div>
          <p class="uid-text">UID: U1a2b3c4d5e</p>
          <p class="qr-hint">掃碼查看個人資料卡片</p>
        </div>
      </div>
    </section>

    <!-- PAGE: Paper Doll -->
    <section class="page" id="page-paperdoll">
      <div class="page-header">
        <button class="back-btn" onclick="App.goBack()">←</button>
        <h2>紙娃娃編輯</h2>
        <button class="text-btn">儲存</button>
      </div>
      <div class="paperdoll-preview">
        <div class="doll-canvas" id="doll-canvas">
          <div class="doll-layer bg">背景</div>
          <div class="doll-layer silhouette">人形</div>
          <div class="doll-layer shoes">鞋</div>
          <div class="doll-layer pants">褲</div>
          <div class="doll-layer body">衣</div>
          <div class="doll-layer head">頭</div>
          <div class="doll-layer pet">寵物</div>
          <div class="doll-layer accessory">配件</div>
        </div>
      </div>
      <div class="tab-bar compact">
        <button class="tab active">頭部</button>
        <button class="tab">球衣</button>
        <button class="tab">球褲</button>
        <button class="tab">鞋子</button>
        <button class="tab">寵物</button>
        <button class="tab">背景</button>
        <button class="tab">配件</button>
      </div>
      <div class="doll-items">
        <div class="doll-item selected">球</div>
        <div class="doll-item">帽</div>
        <div class="doll-item">冠</div>
        <div class="doll-item locked">鎖</div>
        <div class="doll-item locked">鎖</div>
      </div>
      <div class="doll-actions">
        <button class="outline-btn">移除此部位</button>
        <button class="primary-btn">穿戴選中</button>
      </div>
    </section>

    <!-- PAGE: Achievements -->
    <section class="page" id="page-achievements">
      <div class="page-header">
        <button class="back-btn" onclick="App.goBack()">←</button>
        <h2>成就系統</h2>
      </div>
      <div class="achievement-grid" id="achievement-grid"></div>
    </section>

    <!-- PAGE: Badges -->
    <section class="page" id="page-badges">
      <div class="page-header">
        <button class="back-btn" onclick="App.goBack()">←</button>
        <h2>徽章收藏</h2>
      </div>
      <div class="badge-grid" id="badge-grid"></div>
    </section>

    <!-- PAGE: Titles -->
    <section class="page" id="page-titles">
      <div class="page-header">
        <button class="back-btn" onclick="App.goBack()">←</button>
        <h2>稱號設定</h2>
      </div>
      <div class="title-config">
        <div class="title-preview" id="title-preview">冠軍.全勤.小麥</div>
        <div class="title-row">
          <label>大成就稱號</label>
          <select id="title-big"><option>冠軍</option><option>MVP</option><option>（無）</option></select>
        </div>
        <div class="title-row">
          <label>普通稱號</label>
          <select id="title-normal"><option>全勤</option><option>鐵人</option><option>（無）</option></select>
        </div>
        <div class="title-row">
          <label>LINE 暱稱</label>
          <input type="text" value="小麥" disabled>
        </div>
        <button class="primary-btn full-width">儲存稱號</button>
      </div>
    </section>

    <!-- PAGE: Scan QR -->
    <section class="page" id="page-scan" data-min-role="coach">
      <div class="page-header">
        <button class="back-btn" onclick="App.goBack()">←</button>
        <h2>掃碼簽到 / 簽退</h2>
      </div>
      <div class="scan-content">
        <div class="scan-event">當前活動：<strong>週六足球友誼賽</strong></div>
        <div class="scan-mode-toggle">
          <button class="scan-mode active">簽到</button>
          <button class="scan-mode">簽退</button>
        </div>
        <div class="scan-camera">
          <div class="scan-frame">相機掃碼區</div>
        </div>
        <div class="scan-manual">
          <span>或手動輸入 UID：</span>
          <div class="scan-input-row">
            <input type="text" placeholder="U1a2b3c...">
            <button class="primary-btn">確認</button>
          </div>
        </div>
        <div class="scan-results" id="scan-results">
          <div class="scan-result success">暱稱A 簽到成功</div>
          <div class="scan-result warning">暱稱B 已完成簽到</div>
          <div class="scan-result error">暱稱C 未報名此活動</div>
        </div>
        <div class="scan-stats">
          <div>已簽到：<strong>12</strong>/20</div>
          <div>已簽退：<strong>8</strong>/12</div>
        </div>
      </div>
    </section>

    <!-- PAGE: Tournament Center (bottom tab) -->
    <section class="page" id="page-tournaments">
      <div class="page-header">
        <h2>賽事中心</h2>
      </div>
      <div id="tournament-timeline"></div>
    </section>

    <!-- PAGE: Tournament Detail -->
    <section class="page" id="page-tournament-detail">
      <div class="page-header">
        <button class="back-btn" onclick="App.goBack()">←</button>
        <h2 id="td-title">賽事名稱</h2>
        <button class="text-btn" onclick="App.toggleModal('rules-modal')">規則</button>
      </div>
      <div class="td-img-placeholder" id="td-img-placeholder">賽事圖片 800 × 300</div>
      <div class="tab-bar" id="td-tabs">
        <button class="tab active" data-ttab="schedule">賽程</button>
        <button class="tab" data-ttab="standings">排名</button>
        <button class="tab" data-ttab="trades">交易</button>
      </div>
      <div class="tournament-content" id="tournament-content"></div>
    </section>

    <!-- PAGE: Second Hand Shop -->
    <section class="page" id="page-shop">
      <div class="page-header">
        <button class="back-btn" onclick="App.goBack()">←</button>
        <h2>二手商品區</h2>
      </div>
      <div class="filter-bar visible">
        <select><option>全部分類</option><option>球鞋</option><option>球衣</option><option>護具</option></select>
        <select><option>全部價格</option><option>$0~500</option><option>$500~1500</option><option>$1500+</option></select>
        <select><option>最新上架</option><option>最舊上架</option></select>
      </div>
      <div class="shop-grid" id="shop-grid"></div>
    </section>

    <!-- PAGE: Shop Detail -->
    <section class="page" id="page-shop-detail">
      <div class="page-header">
        <button class="back-btn" onclick="App.goBack()">←</button>
        <h2 id="shop-detail-title">商品名稱</h2>
      </div>
      <div class="detail-body" id="shop-detail-body"></div>
    </section>

    <!-- PAGE: Leaderboard -->
    <section class="page" id="page-leaderboard">
      <div class="page-header">
        <button class="back-btn" onclick="App.goBack()">←</button>
        <h2>排行榜</h2>
      </div>
      <div class="tab-bar compact">
        <button class="tab active">週</button>
        <button class="tab">雙週</button>
        <button class="tab">月</button>
        <button class="tab">季</button>
        <button class="tab">年</button>
      </div>
      <div class="leaderboard-list" id="leaderboard-list"></div>
    </section>

    <!-- PAGE: User Card (Scan result) -->
    <section class="page" id="page-user-card">
      <div class="page-header">
        <button class="back-btn" onclick="App.goBack()">←</button>
        <h2>用戶資料卡片</h2>
      </div>
      <div class="user-card-full" id="user-card-full"></div>
    </section>

    <!-- ========== BACKEND PAGES ========== -->

    <!-- PAGE: My Activities (Coach+) -->
    <section class="page" id="page-my-activities" data-min-role="coach">
      <div class="page-header">
        <button class="back-btn" onclick="App.goBack()">←</button>
        <h2>我的活動管理</h2>
        <button class="primary-btn small" onclick="App.showModal('create-event-modal')">＋ 新增</button>
      </div>
      <div class="card-list" id="my-activity-list"></div>
    </section>

    <!-- PAGE: Backend - User Management (Admin+) -->
    <section class="page" id="page-admin-users" data-min-role="admin">
      <div class="page-header">
        <button class="back-btn" onclick="App.goBack()">←</button>
        <h2>用戶管理</h2>
      </div>
      <div class="admin-search">
        <input type="text" placeholder="搜尋 UID 或暱稱...">
        <div class="admin-filters">
          <select><option>全部身份</option><option>一般用戶</option><option>教練</option><option>領隊</option><option>場主</option></select>
          <select><option>全部地區</option><option>台北</option><option>台中</option></select>
        </div>
      </div>
      <div class="admin-card-list" id="admin-user-list"></div>
    </section>

    <!-- PAGE: Backend - EXP Management (Super Admin) -->
    <section class="page" id="page-admin-exp" data-min-role="super_admin">
      <div class="page-header">
        <button class="back-btn" onclick="App.goBack()">←</button>
        <h2>手動 EXP 管理</h2>
      </div>
      <div class="admin-search">
        <input type="text" placeholder="搜尋 UID 或暱稱..." id="exp-search">
        <button class="primary-btn" onclick="App.demoExpSearch()">搜尋</button>
      </div>
      <div class="exp-target-card" id="exp-target-card">
        <div class="exp-target-info">
          <div class="profile-avatar small">A</div>
          <div>
            <div class="exp-target-name">暱稱A</div>
            <div class="exp-target-detail">UID: Uxxxxxx ・ Lv.25 ・ EXP: 2350</div>
          </div>
        </div>
        <div class="exp-form">
          <div class="form-row">
            <label>EXP 調整</label>
            <input type="number" placeholder="+500 或 -100" value="500">
          </div>
          <div class="form-row">
            <label>備註原因 <span class="required">*必填</span></label>
            <input type="text" placeholder="例：活動獎勵">
          </div>
          <button class="primary-btn full-width">確認送出</button>
        </div>
      </div>
      <div class="info-card">
        <div class="info-title">最近操作紀錄</div>
        <div class="log-list" id="exp-log-list"></div>
      </div>
    </section>

    <!-- PAGE: Backend - Ad Management (Admin+) -->
    <section class="page" id="page-admin-banners" data-min-role="admin">
      <div class="page-header">
        <button class="back-btn" onclick="App.goBack()">←</button>
        <h2>廣告管理</h2>
      </div>
      <div class="admin-section-label">Banner 廣告</div>
      <div class="card-list" id="banner-manage-list"></div>
      <button class="primary-btn full-width" style="margin:.5rem 0" onclick="App.showBannerForm()">＋ 新增 Banner</button>
      <div class="form-card" id="banner-form-card" style="display:none">
        <div class="role-editor-header"><span id="banner-form-title">新增 Banner</span><button class="text-btn" onclick="App.hideBannerForm()">取消</button></div>
        <div class="form-row"><label>標題</label><input type="text" id="banner-input-title" placeholder="例：春季聯賽 Banner"></div>
        <div class="form-row"><label>位置</label><select id="banner-input-position"><option value="主輪播">主輪播</option><option value="側邊浮動">側邊浮動</option></select></div>
        <div class="form-row"><label>上架時間</label><input type="datetime-local" id="banner-input-publish"></div>
        <div class="form-row"><label>下架時間</label><input type="datetime-local" id="banner-input-unpublish"></div>
        <button class="primary-btn full-width" onclick="App.saveBanner()">儲存</button>
      </div>
      <div class="admin-section-label" style="margin-top:1.2rem">浮動廣告 (AD1 / AD2)</div>
      <div class="card-list" id="floating-ad-manage-list"></div>
      <button class="primary-btn full-width" style="margin:.5rem 0" onclick="App.showFloatingAdForm()">＋ 新增浮動廣告</button>
      <div class="form-card" id="floatad-form-card" style="display:none">
        <div class="role-editor-header"><span id="floatad-form-title">新增浮動廣告</span><button class="text-btn" onclick="App.hideFloatingAdForm()">取消</button></div>
        <div class="form-row"><label>廣告標題</label><input type="text" id="floatad-input-title" placeholder="例：球鞋促銷"></div>
        <div class="form-row"><label>上架時間</label><input type="datetime-local" id="floatad-input-publish"></div>
        <div class="form-row"><label>下架時間</label><input type="datetime-local" id="floatad-input-unpublish"></div>
        <button class="primary-btn full-width" onclick="App.saveFloatingAd()">儲存</button>
      </div>
    </section>

    <!-- PAGE: Backend - Shop Management (Admin+) -->
    <section class="page" id="page-admin-shop" data-min-role="admin">
      <div class="page-header">
        <button class="back-btn" onclick="App.goBack()">←</button>
        <h2>二手商品管理</h2>
        <button class="primary-btn small" onclick="App.showModal('create-shop-modal')">＋ 新增</button>
      </div>
      <div class="admin-search">
        <input type="text" placeholder="搜尋商品...">
      </div>
      <div class="card-list" id="shop-manage-list"></div>
    </section>

    <!-- PAGE: Backend - Team Management (Admin+) -->
    <section class="page" id="page-admin-teams" data-min-role="admin">
      <div class="page-header">
        <button class="back-btn" onclick="App.goBack()">←</button>
        <h2>球隊管理</h2>
      </div>
      <div class="admin-search">
        <input type="text" id="team-search-input" placeholder="搜尋球隊名稱 / 領隊..." oninput="App.filterAdminTeams()">
      </div>
      <div class="card-list" id="admin-team-list"></div>
    </section>

    <!-- PAGE: Backend - Message Management (Admin+) -->
    <section class="page" id="page-admin-messages" data-min-role="admin">
      <div class="page-header">
        <button class="back-btn" onclick="App.goBack()">←</button>
        <h2>站內信管理</h2>
        <button class="primary-btn small" onclick="App.showMsgCompose()">＋ 群發</button>
      </div>
      <div class="tab-bar" id="msg-manage-tabs">
        <button class="tab active" data-mfilter="sent">已發送</button>
        <button class="tab" data-mfilter="scheduled">已排程</button>
        <button class="tab" data-mfilter="recalled">已回收</button>
      </div>
      <div class="card-list" id="msg-manage-list"></div>
      <div class="form-card" id="msg-compose" style="display:none;margin-top:.5rem">
        <div class="role-editor-header"><span>撰寫群發信</span><button class="text-btn" onclick="document.getElementById('msg-compose').style.display='none'">取消</button></div>
        <div class="form-row"><label>標題</label><input type="text" id="msg-title" placeholder="信件標題"></div>
        <div class="form-row"><label>對象</label><select id="msg-target"><option>全體用戶</option><option>教練以上</option><option>管理員</option><option>指定球隊</option></select></div>
        <div class="form-row"><label>內容</label><textarea id="msg-body" rows="4" placeholder="信件內容..."></textarea></div>
        <div class="form-row">
          <label>排程發送</label>
          <input type="datetime-local" id="msg-schedule">
        </div>
        <button class="primary-btn full-width" onclick="App.sendDemoMsg()">發送</button>
      </div>
    </section>

    <!-- PAGE: Backend - Tournament Management (Admin+) -->
    <section class="page" id="page-admin-tournaments" data-min-role="admin">
      <div class="page-header">
        <button class="back-btn" onclick="App.goBack()">←</button>
        <h2>賽事管理</h2>
        <button class="primary-btn small" onclick="App.showModal('create-tournament-modal')">＋ 新增</button>
      </div>
      <div class="card-list" id="tournament-manage-list"></div>
    </section>

    <!-- PAGE: Backend - Achievement Management (Super Admin) -->
    <section class="page" id="page-admin-achievements" data-min-role="super_admin">
      <div class="page-header">
        <button class="back-btn" onclick="App.goBack()">←</button>
        <h2>成就 / 徽章管理</h2>
      </div>
      <div class="tab-bar" id="admin-ach-tabs">
        <button class="tab active" data-atype="achievements">成就</button>
        <button class="tab" data-atype="badges">徽章</button>
      </div>
      <div id="admin-ach-list"></div>
      <button class="primary-btn full-width" style="margin-top:.5rem" onclick="App._adminAchTab==='achievements'?App.showAchForm():App.showBadgeForm()">＋ 新增</button>

      <!-- Achievement Create/Edit Form -->
      <div class="form-card" id="ach-form-card" style="display:none;margin-top:.5rem">
        <div class="role-editor-header">
          <span id="ach-form-title">新增成就</span>
          <button class="text-btn" onclick="App.hideAchForm()">取消</button>
        </div>
        <div class="form-row"><label>成就名稱</label><input type="text" id="ach-input-name" placeholder="例：百場達人"></div>
        <div class="form-row"><label>描述（目標條件）</label><input type="text" id="ach-input-desc" placeholder="例：累計參加 100 場活動"></div>
        <div class="form-row"><label>目標次數</label><input type="number" id="ach-input-target" value="10" min="1"></div>
        <div class="form-row">
          <label>類別（框線顏色）</label>
          <select id="ach-input-category">
            <option value="bronze">銅</option>
            <option value="silver">銀</option>
            <option value="gold">金</option>
          </select>
        </div>
        <div style="font-size:.72rem;color:var(--text-muted);margin-bottom:.5rem">建立成就時會自動建立關聯徽章；修改目標次數後，未達新目標的用戶將變回未完成</div>
        <button class="primary-btn full-width" onclick="App.saveAchievement()">儲存</button>
      </div>

      <!-- Badge Create/Edit Form -->
      <div class="form-card" id="badge-form-card" style="display:none;margin-top:.5rem">
        <div class="role-editor-header">
          <span id="badge-form-title">新增徽章</span>
          <button class="text-btn" onclick="App.hideBadgeForm()">取消</button>
        </div>
        <div class="form-row"><label>徽章名稱</label><input type="text" id="badge-input-name" placeholder="例：冠軍徽章"></div>
        <div class="form-row">
          <label>類別（框線顏色）</label>
          <select id="badge-input-category">
            <option value="bronze">銅</option>
            <option value="silver">銀</option>
            <option value="gold">金</option>
          </select>
        </div>
        <div class="form-row">
          <label>關聯成就</label>
          <select id="badge-input-ach"><option value="">（不關聯成就）</option></select>
        </div>
        <div style="font-size:.72rem;color:var(--text-muted);margin-bottom:.5rem">徽章圖片將來可從此處上傳（目前顯示為預留框）</div>
        <button class="primary-btn full-width" onclick="App.saveBadge()">儲存</button>
      </div>
    </section>

    <!-- PAGE: Backend - Announcement Management (Super Admin) -->
    <section class="page" id="page-admin-announcements" data-min-role="super_admin">
      <div class="page-header">
        <button class="back-btn" onclick="App.goBack()">←</button>
        <h2>系統公告管理</h2>
      </div>
      <div class="card-list" id="announcement-manage-list"></div>
      <button class="primary-btn full-width" style="margin:.5rem 0" onclick="App.showAnnouncementForm()">＋ 新增公告</button>
      <div class="form-card" id="announcement-form-card" style="display:none">
        <div class="role-editor-header"><span id="announcement-form-title">新增公告</span><button class="text-btn" onclick="App.hideAnnouncementForm()">取消</button></div>
        <div class="form-row"><label>公告標題</label><input type="text" id="ann-input-title" placeholder="例：系統維護通知"></div>
        <div class="form-row"><label>公告內容</label><textarea id="ann-input-content" rows="4" placeholder="公告內容..."></textarea></div>
        <div class="form-row"><label>發布方式</label><select id="ann-input-publish-type" onchange="App.toggleAnnSchedule()"><option value="now">立即發布</option><option value="scheduled">預約發布</option></select></div>
        <div class="form-row" id="ann-schedule-row" style="display:none"><label>預約發布時間</label><input type="datetime-local" id="ann-input-schedule"></div>
        <button class="primary-btn full-width" onclick="App.saveAnnouncementItem()">儲存</button>
      </div>
    </section>

    <!-- PAGE: Backend - Custom Roles (Super Admin) -->
    <section class="page" id="page-admin-roles" data-min-role="super_admin">
      <div class="page-header">
        <button class="back-btn" onclick="App.goBack()">←</button>
        <h2>自訂層級管理</h2>
      </div>
      <div class="role-hierarchy-card">
        <div class="role-hierarchy-title">目前層級架構</div>
        <div class="role-hierarchy-list" id="role-hierarchy-list"></div>
      </div>
      <div class="role-editor-card" id="role-editor-card" style="display:none">
        <div class="role-editor-header">
          <span id="role-editor-title">新增自訂層級</span>
          <button class="text-btn" onclick="document.getElementById('role-editor-card').style.display='none'">取消</button>
        </div>
        <div class="form-row"><label>層級名稱</label><input type="text" id="role-name-input" placeholder="例：裁判、助理教練"></div>
        <div class="form-row"><label>層級顏色</label><input type="color" id="role-color-input" value="#6366f1" style="width:100%;height:36px;border:none;cursor:pointer"></div>
        <div class="form-row">
          <label>插入位置（介於）</label>
          <select id="role-position-select"></select>
        </div>
        <div class="form-row">
          <label>權限設定</label>
          <div class="permissions-list" id="permissions-list"></div>
        </div>
        <button class="primary-btn full-width" onclick="App.showToast('層級已儲存（Demo）')">儲存層級</button>
      </div>
      <button class="primary-btn full-width" style="margin-top:.5rem" onclick="App.openRoleEditor()">＋ 新增自訂層級</button>
    </section>

    <!-- PAGE: Backend - Inactive Data (Super Admin) -->
    <section class="page" id="page-admin-inactive" data-min-role="super_admin">
      <div class="page-header">
        <button class="back-btn" onclick="App.goBack()">←</button>
        <h2>無效資料查詢</h2>
      </div>
      <div class="tab-bar">
        <button class="tab active">已解散球隊</button>
        <button class="tab">已結束賽事</button>
      </div>
      <div class="card-list" id="inactive-list"></div>
    </section>

    <!-- PAGE: Backend - Operation Logs (Super Admin) -->
    <section class="page" id="page-admin-logs" data-min-role="super_admin">
      <div class="page-header">
        <button class="back-btn" onclick="App.goBack()">←</button>
        <h2>操作日誌</h2>
      </div>
      <div class="admin-search">
        <input type="text" placeholder="搜尋操作者 / 目標...">
        <div class="admin-filters">
          <select><option>全部類型</option><option>手動EXP</option><option>晉升用戶</option><option>活動管理</option></select>
        </div>
      </div>
      <div class="log-list" id="operation-log-list"></div>
    </section>

  </main>

  <!-- ============ BOTTOM TAB BAR ============ -->
  <nav id="bottom-tabs">
    <button class="bot-tab active" data-page="page-home">
      <svg viewBox="0 0 24 24" width="22" height="22" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2z"/></svg>
      <span>首頁</span>
    </button>
    <button class="bot-tab" data-page="page-activities">
      <svg viewBox="0 0 24 24" width="22" height="22" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="4" width="18" height="18" rx="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>
      <span>活動</span>
    </button>
    <button class="bot-tab" data-page="page-teams">
      <svg viewBox="0 0 24 24" width="22" height="22" fill="none" stroke="currentColor" stroke-width="2"><path d="M17 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 00-3-3.87"/><path d="M16 3.13a4 4 0 010 7.75"/></svg>
      <span>球隊</span>
    </button>
    <button class="bot-tab" data-page="page-tournaments">
      <svg viewBox="0 0 24 24" width="22" height="22" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 9H4.5a2.5 2.5 0 010-5C7 4 7 7 7 7"/><path d="M18 9h1.5a2.5 2.5 0 000-5C17 4 17 7 17 7"/><path d="M4 22h16"/><path d="M10 14.66V22"/><path d="M14 14.66V22"/><path d="M8 6v4a4 4 0 008 0V6H8z"/></svg>
      <span>賽事</span>
    </button>
    <button class="bot-tab" data-page="page-profile">
      <svg viewBox="0 0 24 24" width="22" height="22" fill="none" stroke="currentColor" stroke-width="2"><path d="M20 21v-2a4 4 0 00-4-4H8a4 4 0 00-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
      <span>我的</span>
    </button>
  </nav>

  <!-- ============ MODALS ============ -->
  <div class="modal-overlay" id="modal-overlay"></div>
  
  <div class="modal" id="rules-modal">
    <div class="modal-header">
      <h3>賽事規則</h3>
      <button class="modal-close" onclick="App.closeModal()">✕</button>
    </div>
    <div class="modal-body">
      <h4>積分規則</h4>
      <p>勝利：3分 ・ 平手：1分 ・ 落敗：0分</p>
      <h4>紅黃牌規則（預設英超）</h4>
      <p>累計 5 張黃牌 → 停賽 1 場<br>累計 10 張黃牌 → 停賽 2 場<br>直接紅牌 → 停賽 3 場（最低）</p>
      <h4>交易窗口</h4>
      <p>2026/03/01 ~ 2026/03/20</p>
    </div>
  </div>

  <div class="modal" id="confirm-modal">
    <div class="modal-header">
      <h3 id="confirm-title">確認操作</h3>
      <button class="modal-close" onclick="App.closeModal()">✕</button>
    </div>
    <div class="modal-body" id="confirm-body"></div>
    <div class="modal-actions">
      <button class="outline-btn" onclick="App.closeModal()">取消</button>
      <button class="primary-btn" onclick="App.closeModal()">確認</button>
    </div>
  </div>

  <!-- Create Event Modal -->
  <div class="modal" id="create-event-modal">
    <div class="modal-header">
      <h3>新增活動</h3>
      <button class="modal-close" onclick="App.closeModal()">✕</button>
    </div>
    <div class="modal-body">
      <div class="ce-form">
        <div class="ce-row">
          <label>活動封面圖片</label>
          <div class="ce-upload" id="ce-upload-area">
            <input type="file" id="ce-image" accept=".jpg,.jpeg,.png" hidden>
            <div class="ce-upload-placeholder" id="ce-upload-preview" onclick="document.getElementById('ce-image').click()">
              <span class="ce-upload-icon">+</span>
              <span class="ce-upload-text">點擊上傳圖片</span>
              <span class="ce-upload-hint">建議尺寸 800 × 300 px｜JPG / PNG｜最大 2MB</span>
            </div>
          </div>
        </div>
        <div class="ce-row">
          <label>活動名稱</label>
          <input type="text" id="ce-title" placeholder="例：週六足球友誼賽">
        </div>
        <div class="ce-row">
          <label>活動類型</label>
          <select id="ce-type">
            <option value="friendly">友誼賽</option>
            <option value="training">訓練</option>
            <option value="camp">學習營</option>
            <option value="league">聯賽</option>
            <option value="cup">盃賽</option>
            <option value="test">測試</option>
            <option value="watch">觀賽</option>
          </select>
        </div>
        <div class="ce-row">
          <label>地點</label>
          <input type="text" id="ce-location" placeholder="例：台北市大安運動中心">
        </div>
        <div class="ce-row ce-row-half">
          <div>
            <label>日期</label>
            <input type="date" id="ce-date" value="2026-03-01">
          </div>
          <div>
            <label>時間</label>
            <input type="text" id="ce-time" placeholder="14:00~16:00" value="14:00~16:00">
          </div>
        </div>
        <div class="ce-row ce-row-half">
          <div>
            <label>費用 ($)</label>
            <input type="number" id="ce-fee" placeholder="0" value="300">
          </div>
          <div>
            <label>人數上限</label>
            <input type="number" id="ce-max" placeholder="20" value="20">
          </div>
        </div>
        <div class="ce-row">
          <label>候補上限</label>
          <input type="number" id="ce-waitlist" placeholder="5" value="5">
        </div>
        <div class="ce-row">
          <label>年齡限制（歲以上，0 為不限）</label>
          <input type="number" id="ce-min-age" placeholder="0" value="0" min="0">
        </div>
        <div class="ce-row">
          <label>注意事項（上限 500 字）</label>
          <textarea id="ce-notes" rows="3" maxlength="500" placeholder="例如：請自備球鞋、飲用水，遲到15分鐘以上視為缺席..."></textarea>
        </div>
      </div>
    </div>
    <div class="modal-actions">
      <button class="outline-btn" onclick="App.closeModal()">取消</button>
      <button class="primary-btn" onclick="App.handleCreateEvent()">建立活動</button>
    </div>
  </div>

  <!-- Create Tournament Modal -->
  <div class="modal" id="create-tournament-modal">
    <div class="modal-header">
      <h3>新增賽事</h3>
      <button class="modal-close" onclick="App.closeModal()">✕</button>
    </div>
    <div class="modal-body">
      <div class="ce-form">
        <div class="ce-row">
          <label>賽事封面圖片</label>
          <div class="ce-upload" id="ct-upload-area">
            <input type="file" id="ct-image" accept=".jpg,.jpeg,.png" hidden>
            <div class="ce-upload-placeholder" id="ct-upload-preview" onclick="document.getElementById('ct-image').click()">
              <span class="ce-upload-icon">+</span>
              <span class="ce-upload-text">點擊上傳圖片</span>
              <span class="ce-upload-hint">建議尺寸 800 × 300 px｜JPG / PNG｜最大 2MB</span>
            </div>
          </div>
        </div>
        <div class="ce-row">
          <label>賽事名稱</label>
          <input type="text" id="ct-name" placeholder="例：2026 春季足球聯賽">
        </div>
        <div class="ce-row">
          <label>賽事類型</label>
          <select id="ct-type">
            <option value="聯賽（雙循環）">聯賽（雙循環）</option>
            <option value="盃賽（單敗淘汰）">盃賽（單敗淘汰）</option>
            <option value="盃賽（分組+淘汰）">盃賽（分組+淘汰）</option>
          </select>
        </div>
        <div class="ce-row ce-row-half">
          <div>
            <label>參賽隊伍數</label>
            <input type="number" id="ct-teams" value="8">
          </div>
          <div>
            <label>賽事狀態</label>
            <select id="ct-status">
              <option value="報名中">報名中</option>
              <option value="即將開始">即將開始</option>
              <option value="進行中">進行中</option>
            </select>
          </div>
        </div>
      </div>
    </div>
    <div class="modal-actions">
      <button class="outline-btn" onclick="App.closeModal()">取消</button>
      <button class="primary-btn" onclick="App.handleCreateTournament()">建立賽事</button>
    </div>
  </div>

  <!-- Create Shop Item Modal -->
  <div class="modal" id="create-shop-modal">
    <div class="modal-header">
      <h3>新增二手商品</h3>
      <button class="modal-close" onclick="App.closeModal()">✕</button>
    </div>
    <div class="modal-body">
      <div class="ce-form">
        <div class="ce-row">
          <label>商品圖片（最多 3 張）</label>
          <div class="cs-img-row">
            <div class="cs-img-upload">
              <input type="file" id="cs-img1" accept=".jpg,.jpeg,.png" hidden>
              <div class="ce-upload-placeholder cs-preview" id="cs-preview1" onclick="document.getElementById('cs-img1').click()">
                <span class="ce-upload-icon">+</span>
                <span class="ce-upload-hint">JPG/PNG 2MB</span>
              </div>
            </div>
            <div class="cs-img-upload">
              <input type="file" id="cs-img2" accept=".jpg,.jpeg,.png" hidden>
              <div class="ce-upload-placeholder cs-preview" id="cs-preview2" onclick="document.getElementById('cs-img2').click()">
                <span class="ce-upload-icon">+</span>
                <span class="ce-upload-hint">JPG/PNG 2MB</span>
              </div>
            </div>
            <div class="cs-img-upload">
              <input type="file" id="cs-img3" accept=".jpg,.jpeg,.png" hidden>
              <div class="ce-upload-placeholder cs-preview" id="cs-preview3" onclick="document.getElementById('cs-img3').click()">
                <span class="ce-upload-icon">+</span>
                <span class="ce-upload-hint">JPG/PNG 2MB</span>
              </div>
            </div>
          </div>
          <span class="ce-upload-hint" style="margin-top:.2rem">建議尺寸 400 × 300 px｜JPG / PNG｜每張最大 2MB</span>
        </div>
        <div class="ce-row">
          <label>商品名稱</label>
          <input type="text" id="cs-name" placeholder="例：Nike Phantom GT2">
        </div>
        <div class="ce-row ce-row-half">
          <div>
            <label>新舊程度</label>
            <select id="cs-condition">
              <option value="全新">全新</option>
              <option value="9成新" selected>9成新</option>
              <option value="8成新">8成新</option>
              <option value="7成新">7成新</option>
              <option value="6成新以下">6成新以下</option>
            </select>
          </div>
          <div>
            <label>價格 ($)</label>
            <input type="number" id="cs-price" placeholder="0">
          </div>
        </div>
        <div class="ce-row">
          <label>尺寸 / 規格</label>
          <input type="text" id="cs-size" placeholder="例：US10、L、M">
        </div>
        <div class="ce-row">
          <label>商品描述（上限 500 字）</label>
          <textarea id="cs-desc" rows="4" maxlength="500" placeholder="描述商品狀況、使用次數、附贈配件等..."></textarea>
        </div>
      </div>
    </div>
    <div class="modal-actions">
      <button class="outline-btn" onclick="App.closeModal()">取消</button>
      <button class="primary-btn" onclick="App.handleCreateShopItem()">上架商品</button>
    </div>
  </div>

  <!-- Lightbox -->
  <div id="lightbox" class="lightbox" onclick="App.closeLightbox()">
    <img id="lightbox-img" src="" alt="">
    <button class="lightbox-close">✕</button>
  </div>

  <!-- Toast -->
  <div id="toast" class="toast"></div>

  <!-- Loading Overlay (Firebase init) -->
  <div id="loading-overlay" class="loading-overlay" style="display:none">
    <div class="loading-spinner"></div>
    <div style="margin-top:.8rem;font-size:.85rem;color:var(--text-secondary)">載入中...</div>
  </div>

  <!-- Firebase SDK (compat v10 CDN) -->
  <script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-storage-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-auth-compat.js"></script>

  <!-- App Scripts -->
  <script src="js/config.js"></script>
  <script src="js/data.js"></script>
  <script src="js/firebase-config.js"></script>
  <script src="js/firebase-service.js"></script>
  <script src="js/api-service.js"></script>
  <script src="app.js"></script>
  <script src="js/renders.js"></script>
  <script src="js/admin.js"></script>
</body>
</html>
