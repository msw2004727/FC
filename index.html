<!DOCTYPE html>
<html lang="zh-Hant" data-theme="light">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>TooSterxHub ?????勗?蝟餌絞</title>
  <meta property="og:title" content="TooSterxHub ?????勗?蝟餌絞">
  <meta property="og:description" content="TooSterxHub??蝷曄黎撟喳嚗???隢蝜怨銝剖?頞喟???澆??????瑕?蝬剖">
  <meta property="og:image" content="https://firebasestorage.googleapis.com/v0/b/fc-football-6c8dc.firebasestorage.app/o/images%2Ftest%2FS__174522375.jpg?alt=media&token=73eb0e3f-a94a-4368-a6df-d4afafaa4ea0">
  <meta property="og:url" content="https://toosterx.com">
  <meta property="og:type" content="website">
  <link rel="icon" href="data:,">
  <!-- CDN ??? + ???伐?霈汗?典 HTML 閫???挾撠梢?憪?頛?SDK嚗?-->
  <link rel="preconnect" href="https://www.gstatic.com">
  <link rel="preconnect" href="https://static.line-scdn.net">
  <link rel="preconnect" href="https://firestore.googleapis.com">
  <link rel="preconnect" href="https://firebasestorage.googleapis.com">
  <link rel="preconnect" href="https://identitytoolkit.googleapis.com">
  <link rel="preconnect" href="https://line-scdn.net" crossorigin>
  <link rel="preload" href="https://www.gstatic.com/firebasejs/10.14.1/firebase-app-compat.js" as="script">
  <link rel="preload" href="https://www.gstatic.com/firebasejs/10.14.1/firebase-firestore-compat.js" as="script">
  <link rel="preload" href="https://www.gstatic.com/firebasejs/10.14.1/firebase-storage-compat.js" as="script">
  <link rel="preload" href="https://www.gstatic.com/firebasejs/10.14.1/firebase-auth-compat.js" as="script">
  <link rel="preload" href="https://www.gstatic.com/firebasejs/10.14.1/firebase-functions-compat.js" as="script">
  <link rel="preload" href="https://static.line-scdn.net/liff/edge/2/sdk.js" as="script">
  <!-- 銝?菜?敹怠?嚗雯????clear=1 ?喳嚗INE ?批遣?汗?券?剁? -->
  <script>
  (function(){
    var V='20260228j';
    var isProd = location.hostname === 'toosterx.com' || location.hostname === 'www.toosterx.com' || location.hostname === 'msw2004727.github.io' || location.hostname === 'fc-3g8.pages.dev';
    // ?clear=1 撘瑕皜翰??
    if(location.search.indexOf('clear=1')!==-1){
      if('caches' in window) caches.keys().then(function(k){k.forEach(function(n){caches.delete(n)})});
      if('serviceWorker' in navigator) navigator.serviceWorker.getRegistrations().then(function(r){r.forEach(function(w){w.unregister()})});
      var old=['sporthub_auto_exp_rules','sporthub_auto_exp_logs'];
      old.forEach(function(k){try{localStorage.removeItem(k)}catch(e){}});
      // 甇????hostname嚗?敹怠???雿菟?蝵桃 production 璅∪?
      if(isProd) localStorage.setItem('sporthub_mode','production');
      localStorage.setItem('sporthub_cache_ver',V);
      location.replace(location.pathname);
      return;
    }
    // ?芸??菜葫?霈? ??皜?SW cache + 靽格迤鋡怨? bug ?航身??demo ?芋撘?
    var prev=localStorage.getItem('sporthub_cache_ver');
    if(prev&&prev!==V){
      if('caches' in window) caches.keys().then(function(k){k.forEach(function(n){caches.delete(n)})});
      if('serviceWorker' in navigator) navigator.serviceWorker.getRegistrations().then(function(r){r.forEach(function(w){w.unregister()})});
      // 甇????hostname嚗??祆?唳??蔭??production嚗耨敺抵?????demo ????
      if(isProd && localStorage.getItem('sporthub_mode')==='demo'){
        localStorage.setItem('sporthub_mode','production');
      }
    }
    localStorage.setItem('sporthub_cache_ver',V);
  })();
  </script>
  <!-- CSS 璅∠????伐?base ??layout ???璅∠? -->
  <link rel="stylesheet" href="css/base.css?v=20260228j">
  <link rel="stylesheet" href="css/layout.css?v=20260228j">
  <link rel="stylesheet" href="css/home.css?v=20260228j">
  <link rel="stylesheet" href="css/activity.css?v=20260228j">
  <link rel="stylesheet" href="css/team.css?v=20260228j">
  <link rel="stylesheet" href="css/profile.css?v=20260228j">
  <link rel="stylesheet" href="css/message.css?v=20260228j">
  <link rel="stylesheet" href="css/tournament.css?v=20260228j">
  <link rel="stylesheet" href="css/shop.css?v=20260228j">
  <link rel="stylesheet" href="css/scan.css?v=20260228j">
  <link rel="stylesheet" href="css/admin.css?v=20260228j">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700;900&family=Outfit:wght@400;500;600;700;800&display=swap" rel="stylesheet">
</head>
<body>
  <!-- ?日?Ｘ嚗雯????debug=1 ? -->
  <script>
  if(location.search.indexOf('debug=1')!==-1){
    var _dbg=document.createElement('div');
    _dbg.id='_debug';
    _dbg.style.cssText='position:fixed;bottom:84px;right:8px;left:8px;max-width:420px;max-height:24vh;overflow:auto;background:rgba(0,0,0,.92);color:#0f0;font:11px/1.5 monospace;padding:8px 10px;z-index:99999;word-break:break-all;-webkit-overflow-scrolling:touch;border:1px solid #333;border-radius:10px;box-shadow:0 8px 24px rgba(0,0,0,.35)';
    _dbg.innerHTML='<div style="color:#888;border-bottom:1px solid #333;padding-bottom:4px;margin-bottom:4px">== Debug Console ==</div>';
    document.documentElement.appendChild(_dbg);
    function _addDbg(t,a){var d=document.createElement('div');d.style.color=t==='error'?'#f55':t==='warn'?'#fa0':'#0f0';d.textContent='['+t+'] '+Array.from(a).map(function(x){try{return typeof x==='object'?JSON.stringify(x):String(x)}catch(e){return String(x)}}).join(' ');_dbg.appendChild(d);_dbg.scrollTop=_dbg.scrollHeight}
    var _oL=console.log,_oE=console.error,_oW=console.warn;
    console.log=function(){_oL.apply(console,arguments);_addDbg('log',arguments)};
    console.error=function(){_oE.apply(console,arguments);_addDbg('error',arguments)};
    console.warn=function(){_oW.apply(console,arguments);_addDbg('warn',arguments)};
    window.addEventListener('error',function(e){_addDbg('error',[e.message,e.filename+':'+e.lineno])});
    window.addEventListener('unhandledrejection',function(e){var r=e.reason;var msg='(unknown)';try{if(r instanceof Error){msg=r.message+(r.stack?'\n'+r.stack:'')}else if(typeof r==='object'&&r!==null){msg=JSON.stringify(r)||String(r)}else{msg=String(r)}}catch(x){msg=String(r)}_addDbg('error',['Promise rejected:',msg])});
  }
  </script>
  <script>
    // ?拇?璅∪??菜葫嚗甇Ｘ迤撘??????Demo ?恍
    (function(){
      var mode = localStorage.getItem('sporthub_mode') ||
        (['toosterx.com','www.toosterx.com','msw2004727.github.io','fc-3g8.pages.dev'].includes(location.hostname) ? 'production' : 'demo');
      if (mode !== 'demo') {
        document.documentElement.classList.add('prod-early');
      }
    })();
  </script>

  <!-- ============ TOP BAR ============ -->
  <header id="top-bar">
    <button id="menu-toggle" aria-label="?詨">
      <span></span><span></span><span></span>
    </button>
    <div class="logo">
      <span class="logo-text">TooSterx Hub</span>
    </div>
    <div class="top-bar-right">
      <div class="sport-picker-wrapper" id="sport-picker-wrapper">
        <button class="sport-picker-btn" id="sport-picker-btn" aria-label="?豢???憿">
          <span class="sport-picker-icon"><span class="sport-emoji" aria-hidden="true">??/span></span>
        </button>
        <div class="sport-picker-dropdown" id="sport-picker-dropdown">
          <div class="sport-picker-header">?豢???憿</div>
          <div id="sport-picker-list"></div>
        </div>
      </div>
      <div id="points-display" class="points-display" title="蝝航?蝛?">
        <span class="points-icon">P</span>
        <span class="points-value" id="points-value">0</span>
      </div>
      <button id="notif-btn" aria-label="?">
        <svg viewBox="0 0 24 24" width="22" height="22" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 8A6 6 0 006 8c0 7-3 9-3 9h18s-3-2-3-9"/><path d="M13.73 21a2 2 0 01-3.46 0"/></svg>
        <span class="notif-badge" id="notif-badge" style="display:none"></span>
      </button>
      <div class="role-switcher-wrapper" id="role-switcher-wrapper" style="display:none">
        <button id="role-avatar-btn" class="role-avatar-btn" aria-label="??頨思遢">
          <div class="role-avatar">暻?/div>
          <span class="role-current-label">銝?祉??/span>
          <span class="role-arrow">??/span>
        </button>
        <div id="role-dropdown" class="role-dropdown">
          <div class="role-dropdown-header">?? Demo 頨思遢</div>
          <button class="role-dropdown-item active" data-role="user">
            <span class="role-icon">U</span>
            <span>銝?祉??/span>
          </button>
          <button class="role-dropdown-item" data-role="coach">
            <span class="role-icon">C</span>
            <span>?毀</span>
          </button>
          <button class="role-dropdown-item" data-role="captain">
            <span class="role-icon">L</span>
            <span>??</span>
          </button>
          <button class="role-dropdown-item" data-role="venue_owner">
            <span class="role-icon">V</span>
            <span>?港蜓</span>
          </button>
          <button class="role-dropdown-item" data-role="admin">
            <span class="role-icon">A</span>
            <span>蝞∠???/span>
          </button>
          <button class="role-dropdown-item" data-role="super_admin">
            <span class="role-icon">S</span>
            <span>蝮賜恣</span>
          </button>
        </div>
      </div>
      <div id="line-login-wrapper" class="line-login-wrapper" style="display:none">
        <button id="line-login-btn" class="line-login-btn" onclick="LineAuth.login()">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="#fff"><path d="M12 2C6.48 2 2 5.83 2 10.5c0 4.18 3.66 7.68 8.58 8.38.33.07.78.22.9.5.1.26.07.66.03.92l-.15.86c-.04.26-.2 1.01.88.55s5.88-3.47 8.03-5.93C22.08 13.79 22 12.18 22 10.5 22 5.83 17.52 2 12 2z"/></svg>
          LINE ?餃
        </button>
        <div id="line-user-topbar" class="line-user-topbar" style="display:none">
          <img id="line-avatar-topbar" class="line-avatar-topbar" src="" alt="" onclick="App.toggleUserMenu()">
          <div id="user-menu-dropdown" class="user-menu-dropdown" style="display:none">
            <div class="user-menu-name" id="user-menu-name"></div>
            <div class="user-menu-divider"></div>
            <button class="user-menu-item" onclick="App.showPage('page-profile'); App.toggleUserMenu()">??鞈?</button>
            <button class="user-menu-item user-menu-logout" onclick="App.logoutLine()">?餃</button>
          </div>
        </div>
      </div>
    </div>
  </header>

  <!-- ============ SIDE DRAWER ============ -->
  <div id="drawer-overlay"></div>
  <nav id="side-drawer">
    <div class="drawer-header">
      <div class="drawer-user">
        <div class="drawer-avatar" id="drawer-avatar"></div>
        <div>
          <div class="drawer-name" id="drawer-name"></div>
          <div class="drawer-role-tag" id="drawer-role-tag"></div>
        </div>
      </div>
    </div>
    <div class="drawer-menu" id="drawer-menu"></div>
    <div class="drawer-footer">
      <button id="theme-toggle">
        <span>瘛梯璅∪?</span>
        <div class="toggle-switch"><div class="toggle-knob"></div></div>
      </button>
      <div id="lang-switcher" class="lang-switcher">
        <span class="lang-label">隤?</span>
        <select id="lang-select" onchange="App.switchLanguage(this.value)"></select>
      </div>
    </div>
  </nav>

  <!-- ============ MAIN CONTENT嚗 PageLoader 頛 pages/*.html嚗?============ -->
  <main id="main-content"></main>

  <!-- ============ BOTTOM TAB BAR ============ -->
  <nav id="bottom-tabs">
    <button class="bot-tab" data-page="page-tournaments">
      <svg viewBox="0 0 24 24" width="22" height="22" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 9H4.5a2.5 2.5 0 010-5C7 4 7 7 7 7"/><path d="M18 9h1.5a2.5 2.5 0 000-5C17 4 17 7 17 7"/><path d="M4 22h16"/><path d="M10 14.66V22"/><path d="M14 14.66V22"/><path d="M8 6v4a4 4 0 008 0V6H8z"/></svg>
      <span>鞈賭?</span>
    </button>
    <button class="bot-tab" data-page="page-teams">
      <svg viewBox="0 0 24 24" width="22" height="22" fill="none" stroke="currentColor" stroke-width="2"><path d="M17 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 00-3-3.87"/><path d="M16 3.13a4 4 0 010 7.75"/></svg>
      <span>??</span>
    </button>
    <div class="bot-tab-center-wrap">
      <button class="bot-tab-qr" onclick="App.showUidQrCode()" aria-label="?? QR Code">
        <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="2" width="8" height="8" rx="1"/><rect x="14" y="2" width="8" height="8" rx="1"/><rect x="2" y="14" width="8" height="8" rx="1"/><rect x="14" y="14" width="4" height="4"/><line x1="22" y1="14" x2="22" y2="18"/><line x1="18" y1="22" x2="22" y2="22"/></svg>
      </button>
      <button class="bot-tab active" data-page="page-home">
        <svg viewBox="0 0 24 24" width="22" height="22" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2z"/></svg>
        <span>擐?</span>
      </button>
    </div>
    <button class="bot-tab" data-page="page-activities">
      <svg viewBox="0 0 24 24" width="22" height="22" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="4" width="18" height="18" rx="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>
      <span>瘣餃?</span>
    </button>
    <button class="bot-tab" data-page="page-profile">
      <svg viewBox="0 0 24 24" width="22" height="22" fill="none" stroke="currentColor" stroke-width="2"><path d="M20 21v-2a4 4 0 00-4-4H8a4 4 0 00-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
      <span>??</span>
    </button>
  </nav>

  <!-- ============ ?典?敶?摰孵嚗 PageLoader 頛 pages/modals.html嚗?============ -->
  <div id="modal-container"></div>

  <!-- Mode Badge -->
  <div id="mode-badge" class="mode-badge">DEMO</div>

  <!-- Toast -->
  <div id="toast" class="toast"></div>

  <!-- Loading Overlay -->
  <div id="loading-overlay" class="loading-overlay" style="display:none" aria-live="polite" aria-busy="true">
    <!-- LIFF init bar -->
    <div id="liff-init-bar"></div>
    <div class="boot-loading" data-boot-loading>
      <div class="boot-loading__image-slot" aria-hidden="true">
        <img id="boot-loading-brand-img" class="boot-loading__image" src="https://firebasestorage.googleapis.com/v0/b/fc-football-6c8dc.firebasestorage.app/o/images%2Ftest%2F260224.png?alt=media&amp;token=3e2a5261-2f31-43f2-baee-bc134e3063b0" alt="" decoding="async">
        <div class="boot-loading__fallback">TooSterx Hub</div>
      </div>
      <div class="boot-loading__head">
        <span>LOADING</span>
        <span class="boot-loading__pct">0%</span>
      </div>
      <div class="boot-loading__bar" role="progressbar" aria-label="App loading" aria-valuemin="0" aria-valuemax="100" aria-valuenow="0">
        <span class="boot-loading__scan" aria-hidden="true"></span>
        <div class="boot-loading__fill"></div>
      </div>
      <div class="boot-loading__sub">蝬脰楝(?芰)甇??芸???銝?..</div>
    </div>
  </div>
  <!-- Deep link 蝑??∠?嚗?鈭恍???脣?IFF 撠 ready ?＊蝷綽? -->
  <div id="liff-deeplink-card" style="display:none">
    <div class="liff-card-spinner"></div>
    <span>甇????嚗撠歲頧?/span>
  </div>
  <!-- 甇?????喲＊蝷箄??交?蝷?+ 摰??閮???-->
  <script>
    (function () {
      var overlay = document.getElementById('loading-overlay');
      var boot = overlay && overlay.querySelector('[data-boot-loading]');
      if (!overlay || !boot) return;

      var img = document.getElementById('boot-loading-brand-img');
      var pctEl = boot.querySelector('.boot-loading__pct');
      var fillEl = boot.querySelector('.boot-loading__fill');
      var barEl = boot.querySelector('.boot-loading__bar');
      var subEl = boot.querySelector('.boot-loading__sub');
      var timer = null;
      var progress = 0;

      function syncImageState() {
        if (!img) return;
        if (img.complete && img.naturalWidth > 0) {
          boot.classList.add('is-image-ready');
        } else {
          boot.classList.remove('is-image-ready');
        }
      }

      function render() {
        var shown = Math.max(0, Math.min(100, Math.floor(progress)));
        if (pctEl) pctEl.textContent = shown + '%';
        if (fillEl) fillEl.style.width = shown + '%';
        if (barEl) barEl.setAttribute('aria-valuenow', String(shown));
      }

      function stop() {
        if (timer) {
          clearInterval(timer);
          timer = null;
        }
      }

      function tick() {
        if (!overlay.isConnected || overlay.style.display === 'none') {
          stop();
          return;
        }
        if (progress >= 92) return;
        var step = progress < 35 ? (4 + Math.random() * 5) :
          progress < 70 ? (2 + Math.random() * 3.5) :
          (0.8 + Math.random() * 1.8);
        progress = Math.min(92, progress + step);
        render();
      }

      function start() {
        if (timer) return;
        tick();
        timer = setInterval(tick, 180);
      }

      if (img) {
        img.addEventListener('load', syncImageState);
        img.addEventListener('error', syncImageState);
        syncImageState();
      }

      if (subEl) {
        var networkLabel = '?芰';
        if (navigator.connection && typeof navigator.connection.effectiveType === 'string' && navigator.connection.effectiveType) {
          networkLabel = navigator.connection.effectiveType;
        } else if (navigator.onLine === false) {
          networkLabel = '?Ｙ?';
        }
        subEl.textContent = '蝬脰楝(' + networkLabel + ')甇??芸???銝?..';
      }

      render();
      window._bootLoadingAnim = { start: start, stop: stop };
    })();
  </script>
  <script>
    if (document.documentElement.classList.contains('prod-early')) {
      document.getElementById('loading-overlay').style.display = '';
      if (window._bootLoadingAnim && typeof window._bootLoadingAnim.start === 'function') {
        window._bootLoadingAnim.start();
      }
      // 摰??嚗?憭＊蝷?20 蝘??亦?ｇ??踹?瘞賊??∩?
      window._loadingSafety = setTimeout(function() {
        var ov = document.getElementById('loading-overlay');
        if (ov && ov.style.display !== 'none') {
          ov.style.display = 'none';
          if (window._bootLoadingAnim && typeof window._bootLoadingAnim.stop === 'function') {
            window._bootLoadingAnim.stop();
          }
          document.documentElement.classList.remove('prod-early');
          console.warn('[Boot] 頛?暹?嚗撥?園???亦??);
        }
      }, 20000);
    }
  </script>

  <!-- Firebase SDK + LIFF SDK ??app.js ??頛嚗?敺?DOMContentLoaded -->

  <!-- QR Code 撱園頛嚗?蝣潭???閬? -->
  <!-- ??scan.js ??頛嚗??憛???-->

  <!-- 憭?閮?箇? -->
  <script defer src="js/i18n.js?v=20260228j"></script>

  <!-- ?詨?撅?-->
  <script defer src="js/config.js?v=20260228j"></script>
  <script defer src="js/data.js?v=20260228j"></script>
  <script defer src="js/firebase-config.js?v=20260228j"></script>
  <script defer src="js/firebase-service.js?v=20260228j"></script>
  <script defer src="js/firebase-crud.js?v=20260228j"></script>
  <script defer src="js/api-service.js?v=20260228j"></script>
  <script defer src="js/line-auth.js?v=20260228j"></script>

  <!-- ?頛??+ ???單頛?剁?敹???App 銋?嚗?-->
  <script defer src="js/core/page-loader.js?v=20260228j"></script>
  <script defer src="js/core/script-loader.js?v=20260228j"></script>

  <!-- ?詨?嚗?蝢?App ?拐辣 + init/renderAll/showToast嚗?-->
  <script defer src="app.js?v=20260228j"></script>

  <!-- 撠鈭? -->
  <script defer src="js/core/navigation.js?v=20260228j"></script>
  <script defer src="js/core/theme.js?v=20260228j"></script>
  <script defer src="js/core/mode.js?v=20260228j"></script>

  <!-- ?璅∠? -->
  <script defer src="js/modules/image-upload.js?v=20260228j"></script>
  <script defer src="js/modules/role.js?v=20260228j"></script>
  <script defer src="js/modules/profile-core.js?v=20260228j"></script>
  <script defer src="js/modules/profile-data.js?v=20260228j"></script>
  <script defer src="js/modules/profile-card.js?v=20260228j"></script>
  <script defer src="js/modules/banner.js?v=20260228j"></script>
  <script defer src="js/modules/ad-manage-core.js?v=20260228j"></script>
  <script defer src="js/modules/ad-manage-banner.js?v=20260228j"></script>
  <script defer src="js/modules/ad-manage-float.js?v=20260228j"></script>
  <script defer src="js/modules/ad-manage-popup-sponsor.js?v=20260228j"></script>
  <script defer src="js/modules/popup-ad.js?v=20260228j"></script>
  <script defer src="js/modules/announcement.js?v=20260228j"></script>
  <script defer src="js/modules/site-theme.js?v=20260228j"></script>
  <script defer src="js/modules/event-list.js?v=20260228j"></script>
  <script defer src="js/modules/event-detail.js?v=20260228j"></script>
  <script defer src="js/modules/event-detail-signup.js?v=20260228j"></script>
  <script defer src="js/modules/event-detail-companion.js?v=20260228j"></script>
  <script defer src="js/modules/event-manage.js?v=20260228j"></script>
  <script defer src="js/modules/event-create.js?v=20260228j"></script>
  <script defer src="js/modules/tournament-render.js?v=20260228j"></script>
  <script defer src="js/modules/tournament-manage.js?v=20260228j"></script>
  <script defer src="js/modules/team-list.js?v=20260228j"></script>
  <script defer src="js/modules/team-detail.js?v=20260228j"></script>
  <script defer src="js/modules/team-form.js?v=20260228j"></script>
  <script defer src="js/modules/message-inbox.js?v=20260228j"></script>
  <script defer src="js/modules/message-admin.js?v=20260228j"></script>
  <script defer src="js/modules/achievement.js?v=20260228j"></script>
  <script defer src="js/modules/favorites.js?v=20260228j"></script>
  <script defer src="js/modules/dashboard.js?v=20260228j"></script>
  <script defer src="js/modules/personal-dashboard.js?v=20260228j"></script>
  <script defer src="js/modules/shop.js?v=20260228j"></script>
  <script defer src="js/modules/leaderboard.js?v=20260228j"></script>
  <script defer src="js/modules/user-admin-list.js?v=20260228j"></script>
  <script defer src="js/modules/user-admin-exp.js?v=20260228j"></script>
  <script defer src="js/modules/error-log.js?v=20260228j"></script>
  <script defer src="js/modules/auto-exp.js?v=20260228j"></script>
  <script defer src="js/modules/user-admin-roles.js?v=20260228j"></script>
  <script defer src="js/modules/scan.js?v=20260228j"></script>
  <script defer src="js/modules/attendance-notify.js?v=20260228j"></script>

  <!-- Service Worker Registration + 撘瑕?湔 -->
  <script>
    if ('serviceWorker' in navigator) {
      // ?菜葫 SW ?湔 ???芸????嚗?銝????蝔葉??嚗?葉??CDN 頛嚗?
      navigator.serviceWorker.addEventListener('controllerchange', function() {
        if (!window._swReloading && !window._appInitializing) {
          window._swReloading = true; location.reload();
        }
      });
      window.addEventListener('load', function() {
        navigator.serviceWorker.register('./sw.js', { updateViaCache: 'none' }).catch(function(){});
      });
    }
  </script>
  <!-- ?單頛憭望???嚗＊蝷箸?敹怠??? -->
  <script>
    window.addEventListener('error', function(e) {
      // ?芣??芸?皞?祈??亙仃??CDN ??頛??script ?勗???onerror ??嚗?憿舐內?典???嚗?
      if (e.target && e.target.tagName === 'SCRIPT' && e.target.src && e.target.src.indexOf(location.origin) === 0) {
        console.error('[Boot] Script failed:', e.target.src);
        var b = document.getElementById('_recovery_btn');
        if (!b) {
          b = document.createElement('button');
          b.id = '_recovery_btn';
          b.textContent = '頛憭望?嚗?甇斗??文翰??閰?;
          b.style.cssText = 'position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);z-index:99999;padding:1rem 2rem;font-size:1rem;background:#dc2626;color:#fff;border:none;border-radius:8px;cursor:pointer';
          b.onclick = function() {
            if ('caches' in window) caches.keys().then(function(k){k.forEach(function(n){caches.delete(n)})});
            if ('serviceWorker' in navigator) navigator.serviceWorker.getRegistrations().then(function(r){r.forEach(function(w){w.unregister()})});
            setTimeout(function(){ location.reload(true); }, 300);
          };
          document.body.appendChild(b);
        }
      }
    }, true);
  </script>
</body>
</html>

